# Генерация печатных форм с помощью разметки и подстановки в шаблоны word
Генерация печатных форм с помощью php на основе шаблонов docx

Цель: 
1) в разы повысить скорость разработки большинства печатных форм за счет шаблонизации (1 форма = 1 день, а не 1 форма = 7-15-20 дней с ошибками).
2) Также повышается удобство разработки: упрощение, нет необходимости бэкэндеру писать HTML.
3) Возможно автоматическое тестирование формы на предмет "вылезает за края","смещения" и др.

Общая суть: 
1) использование библиотеки PHPWORD для генерации печатной формы в docx с помощью размеченного word шаблона от аналитика/заказчика.

Общий алгоритм: 
1) Заказчик выдает печатную форму в docx. 
2) Аналитик или разработчик размечает ее тегами типа ${1}, куда будут подстановкой вставляться данные. 
3) Разработчик подготавливает массив для заполнения - например из результатов заполнения формы или запроса к БД. 
4) Вызывает реализованные функции по генерации документа и получает готовый файл.
5) Его сразу можно переформатировать в pdf, отдавать на скачивание.

Зависимости:
1) Библиотека PHPWORD  https://github.com/PHPOffice/PHPWord https://phpword.readthedocs.io/en/latest/
2) Документация по шаблонизации https://phpword.readthedocs.io/en/latest/templates-processing.html
3) Composer

Установка:
1)  composer require phpoffice/phpword в папку проекта

Основные трюки:
1) Подстановка в разметку из массива (пример createSimpleDocment.php)
2) Копирование элементов и заполнение, например, чтобы сделать таблицу(пример createTable.php)
3) Можно удалять секции и заменять в них текст 
Все описано здесь https://phpword.readthedocs.io/en/latest/templates-processing.html

Что требуется чаще всего (типовые примеры + подходы к ним)
1) Заявления (Заявление в ЛК на перевод на дистанционное обучение. Одностраничные документы с персональной инфой и основным текстом.) - простая подстановка
2) Заявки (как заявления, но с таблицей данных по человеку) - подстановка + генерация таблицы по шаблону
3) Списки людей в таблице с данными - генерация таблицы по шаблону
4) Сложные бланки (пример командировочные заявления) - подстановка
5) Многостраничные статичные: например эл. зачетка (также шаблоны + склейка страниц) 
6) Динамичные, например резюме (удалять невостребованные секции)
7) Крайний случай - рисовать HTML
